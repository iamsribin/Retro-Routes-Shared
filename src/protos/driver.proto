syntax = "proto3";
package driver_package;

service Driver {
  //------------- driver Register rpc ---------
    rpc Register (RegisterReq) returns (CommonRes) {}
    rpc checkRegisterDriver (mobileReq) returns (checkRegisterDriverRes){}
    rpc identificationUpdate (identificationUpdateReq) returns (CommonRes){}
    rpc updateDriverImage (updateDriverImageReq)  returns (CommonRes){}
    rpc vehicleUpdate (vehicleUpdateReq)  returns (CommonRes){}
    rpc vehicleInsurancePollutionUpdate (vehicleInsurancePollutionUpdateReq)  returns (CommonRes){}
    rpc locationUpdate (locationUpdateReq)  returns (CommonRes){}
   // -----------driver login rpc -------------
    rpc CheckLoginDriver (mobileReq) returns (CheckLoginDriverRes) {}
    rpc CheckGoogleLoginDriver (CheckGoogleLoginDriverReq) returns (CheckLoginDriverRes) {}
    rpc GetResubmissionDocuments (idReq) returns (GetResubmissionDocumentsRes) {}
    rpc postResubmissionDocuments (postResubmissionDocumentsReq) returns (CommonRes) {}
    //-------------driver rpc -----------
    rpc fetchDriverProfile(idReq) returns (IResponse_DriverProfileDTO){}
    rpc updateDriverProfile(updateDriverProfileReq) returns (IResponse_UpdateNull){}
    rpc fetchDriverDocuments(idReq) returns (IResponse_DocumentsDTO){}
    rpc updateDriverDocuments (UpdateDriverDocumentsReq) returns (IResponse_UpdateNull){}
    rpc handleOnlineChange(handleOnlineChangeReq) returns (CommonRes) {}
    // ---------- admin's driver rpc ----------
    rpc GetDriversListByAccountStatus(PaginationQuery) returns (IResponse_PaginatedUserListDTO) {}
    rpc AdminUpdateDriverAccountStatus(AdminUpdateDriverStatusReq) returns (IResponse_Boolean){}
    rpc AdminGetDriverDetailsById(IdReq) returns (IResponse_AdminDriverDetailsDTO){}
    // ----------- ride driver rpc -------------
    rpc getOnlineDriverDetails (IdReq) returns (IResponse_OnlineDriverDTO){}
    rpc updateDriverCancelCount (IdReq) returns (IResponse_UpdateNull){}
    rpc AddEarnings (AddEarningsRequest) returns (DriverResponse);
    rpc RollbackEarnings (RollbackEarningsRequest) returns (DriverResponse);
}

message AddEarningsRequest {
  string driverId = 1;
  double adminShare = 2;
  double driverShare = 3;
  string transactionId = 4;
}

message RollbackEarningsRequest {
  string driverId = 1;
  double amount = 2;
}

message DriverResponse {
  string status = 1;
  string message = 2;
}


message handleOnlineChangeReq {
  bool online = 1; 
  string driverId = 2; 
  Coordinates location = 3; 
  string onlineTimestamp = 4; 
}

message Coordinates {
  double lat = 1;
  double lng = 2;
}

message PaginationQuery {
  string page = 1;
  string limit = 2;
  string search = 3;
  string status = 4;
}

message PaginatedUserListDTO {
  repeated AdminDriverListDTO drivers = 1;
  Pagination pagination = 2;
}

message Pagination {
  int32 currentPage = 1;
  int32 totalPages = 2;
  int32 totalItems = 3;
  int32 itemsPerPage = 4;
  bool hasNextPage = 5;
  bool hasPreviousPage = 6;
}

message IResponse_PaginatedUserListDTO {
  int32 status = 1;
  string message = 2;
  string navigate = 3;
  PaginatedUserListDTO data = 4;
}

message OnlineDriverDTO {
  string driverName = 1;
  string driverId = 2;
  int32 cancelledRides = 3;
  string vehicleModel = 4;
  string color = 5;
  float rating = 6;
  string vehicleNumber = 7;
  string driverImage = 8;
  int64 mobile = 9;
}

message IResponse_OnlineDriverDTO {
  int32 status = 1;
  string message = 2;
  string navigate = 3;
  OnlineDriverDTO data = 4;
}

message CreateRideDTO {
  string rideId = 1;
  string driverId = 2;
  string estimatedArrival = 3;
  string status = 4;
}

// ================ REQUEST MESSAGES ====================
message AccountStatusReq {
  string accountStatus = 1;
}

message AdminUpdateDriverStatusReq {
  string id = 1;
  string status = 2;
  string reason = 3;
  repeated string fields = 4; // Optional updated fields
}

message IdReq {
  string id = 1;
}

// ================ RESPONSE WRAPPERS ====================
message IResponse_AdminDriverListDTO {
  int32 status = 1;
  string message = 2;
  string navigate = 3;
  repeated AdminDriverListDTO data = 4;
}

message IResponse_AdminDriverDetailsDTO {
  int32 status = 1;
  string message = 2;
  string navigate = 3;
  AdminDriverDetailsDTO data = 4;
}

message IResponse_Boolean {
  int32 status = 1;
  string message = 2;
  string navigate = 3;
  bool data = 4;
}

// ================ DATA TRANSFER OBJECTS ====================
message AdminDriverListDTO {
  string id = 1;
  string name = 2;
  string email = 3;
  string mobile = 4;
  string joiningDate = 5;
  string accountStatus = 6;
  string vehicle = 7;
  string driverImage = 8;
}

message AdminDriverDetailsDTO {
  string _id = 1;
  string name = 2;
  string email = 3;
  int64 mobile = 4;
  string driverImage = 5;
  string joiningDate = 6;
  string address = 7;
  int32 totalCompletedRides = 8;
  int32 totalCancelledRides = 9;
  int32 walletBalance = 10;
  int32 adminCommission = 11;
  string accountStatus = 12;
  bool isAvailable = 13;
  int32 totalRatings = 14;

  Aadhar aadhar = 15;
  License license = 16;
  VehicleDetailsExtended vehicleDetails = 17;
  Location location = 18;
}

// ================ NESTED/REUSED STRUCTURES ====================
message VehicleDetailsExtended {
  string registrationId = 1;
  string vehicleNumber = 2;
  string vehicleColor = 3;
  string model = 4;
  string rcFrontImageUrl = 5;
  string rcBackImageUrl = 6;
  string carFrontImageUrl = 7;
  string carBackImageUrl = 8;
  string rcStartDate = 9;
  string rcExpiryDate = 10;
  string insuranceImageUrl = 11;
  string insuranceStartDate = 12;
  string insuranceExpiryDate = 13;
  string pollutionImageUrl = 14;
  string pollutionStartDate = 15;
  string pollutionExpiryDate = 16;
}

message Location {
  string latitude = 1;
  string longitude = 2;
  string address = 3;
}

message UpdateDriverDocumentsReq {
  string driverId = 1;
  string section = 2;
  string updates = 3;
}

message IResponse_DocumentsDTO {
  int32 status = 1;
  string message = 2;
  string navigate = 3;
  DriverDocumentDTO data = 4;
}

// === DriverDocumentDTO ===
message DriverDocumentDTO {
  string _id = 1;
  Aadhar aadhar = 2;
  License license = 3;
  VehicleRC vehicleRC = 4;
  VehicleDetails vehicleDetails = 5;
  Insurance insurance = 6;
  Pollution pollution = 7;
}

// === Aadhar ===
message Aadhar {
  string id = 1;
  string frontImageUrl = 2;
  string backImageUrl = 3;
}

// === License ===
message License {
  string id = 1;
  string frontImageUrl = 2;
  string backImageUrl = 3;
  string validity = 4; // Use string for date (ISO format)
}

// === VehicleRC ===
message VehicleRC {
  string registrationId = 1;
  string rcFrontImageUrl = 2;
  string rcBackImageUrl = 3;
  string rcStartDate = 4; // Use string for date
  string rcExpiryDate = 5; // Use string for date
}

// === VehicleDetails ===
message VehicleDetails {
  string vehicleNumber = 1;
  string vehicleColor = 2;
  string model = 3;
  string carFrontImageUrl = 4;
  string carBackImageUrl = 5;
}

// === Insurance ===
message Insurance {
  string insuranceImageUrl = 1;
  string insuranceStartDate = 2;
  string insuranceExpiryDate = 3;
}

// === Pollution ===
message Pollution {
  string pollutionImageUrl = 1;
  string pollutionStartDate = 2;
  string pollutionExpiryDate = 3;
}

message updateDriverProfileReq{
 string driverId = 1;
 string name = 2;
 string imageUrl = 3;
}

message IResponse_UpdateNull {
  int32 status = 1;           
  string message = 2;
  string navigate = 3;
  bool data = 4;  
}

message IResponse_DriverProfileDTO {
  int32 status = 1;           
  string message = 2;
  string navigate = 3;
  DriverProfileDTO data = 4;  
}

message DriverProfileDTO{
 string name = 1;
 string email = 2;
 string mobile = 3;
 string driverImage = 4;
 string address = 5;
 int32 totalRatings = 6;
 string joiningDate = 7;
 int32 completedRides = 8;
 int32 cancelledRides = 9;
 int32 walletBalance = 10;
 int32 adminCommission = 11;
}

message locationUpdateReq{
   string driverId =1;
   string latitude = 2;
   string longitude = 3;
   string address = 4;
}

message vehicleInsurancePollutionUpdateReq{
  string driverId =1;
  string insuranceStartDate =2;
  string insuranceExpiryDate =3;
  string pollutionStartDate =4;
  string pollutionExpiryDate =5;
  string pollutionImageUrl =6;
  string insuranceImageUrl =7;
}

message vehicleUpdateReq{
  string driverId =1;
  string registrationId =2;
  string model = 3;
  string vehicleColor =4;
  string vehicleNumber=5;
  string rcStartDate =6;
  string rcExpiryDate =7;
  string rcFrondImageUrl =8;
  string rcBackImageUrl =9;
  string carFrondImageUrl =10;
  string carBackImageUrl = 11;
}

message updateDriverImageReq{
    string driverId = 1;
    string driverImageUrl = 2;
}

message identificationUpdateReq{
    string driverId = 1;
    string aadharID = 2;
    string licenseID =3;
    string aadharFrontImage = 4;
    string aadharBackImage = 5;
    string licenseValidity =6;
    string licenseFrontImage = 7;
    string licenseBackImage = 8;
}

message mobileReq{
    string mobile = 1;
}

message checkRegisterDriverRes{
   int32 status = 1;
   string message = 2; 
   bool isFullyRegistered = 3;
   string driverId = 4;
   string nextStep = 5;
}

message RegisterReq{
 string name = 1;
 string email = 2;
 string mobile = 3;
 string password = 4;
 string referralCode = 5;
}

message postResubmissionDocumentsReq{
  string driverId = 1;
  string model = 2;
  string insuranceStartDate = 3;
  string insuranceExpiryDate = 4;
  string pollutionStartDate = 5;
  string pollutionExpiryDate = 6;
  string aadharID = 7;
  string licenseID = 8;
  string licenseValidity = 9;
  string carFrontImage = 10;
  string insuranceImage = 11;
  string carBackImage = 12;
  string rcBackImage = 13;
  string pollutionImage = 14;
  string rcFrontImage = 15;
  string driverImage = 16;
  string aadharBackImage = 17;
  string licenseFrontImage = 18;
  string aadharFrontImage = 19;
  string licenseBackImage = 20;
  string registrationId = 21;
  string latitude = 22;
  string longitude = 23;
}

message CheckLoginDriverRes{
    string status = 1;
    string message = 2;
    string navigate = 3;
    string name = 4;
    string refreshToken =5;
    string token = 6;
    string driverId = 7;
}

message CheckGoogleLoginDriverReq{
   string email = 1;
}

message idReq{
string id =1;
}

message GetResubmissionDocumentsRes {
  int32 status = 1;
  string message = 2;
  string navigate = 3; 
  Resubmission data = 4;
}

message CommonRes{
  int32 status = 1;
  string message = 2;
  string id = 3;
  string navigate = 4;
}
/////////////////model///////////////////
message Resubmission {
  string driverId = 1;
  repeated string fields = 2;
}